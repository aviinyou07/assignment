<!-- GLOBAL MODAL SYSTEM -->

<!-- Toast Notification Container -->
<div id="toast-container" class="fixed top-4 right-4 z-[100] space-y-3"></div>

<!-- Confirm Modal -->
<div id="confirm-modal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[90] flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl max-w-md w-full shadow-2xl animate-in fade-in zoom-in duration-200">
    <div class="p-6">
      <div class="flex items-center gap-4 mb-4">
        <div id="confirm-icon" class="w-12 h-12 bg-amber-100 text-amber-600 rounded-xl flex items-center justify-center">
          <i class="fi fi-rr-exclamation text-xl"></i>
        </div>
        <div>
          <h3 id="confirm-title" class="text-lg font-bold text-slate-800">Confirm Action</h3>
          <p id="confirm-message" class="text-sm text-slate-500">Are you sure you want to proceed?</p>
        </div>
      </div>
    </div>
    <div class="border-t px-6 py-4 flex justify-end gap-3 bg-slate-50 rounded-b-2xl">
      <button onclick="closeConfirmModal(false)" class="px-5 py-2.5 text-slate-700 bg-white border border-slate-300 rounded-xl font-bold text-sm hover:bg-slate-50 transition-all">
        Cancel
      </button>
      <button id="confirm-btn" onclick="closeConfirmModal(true)" class="px-5 py-2.5 bg-indigo-600 text-white rounded-xl font-bold text-sm hover:bg-indigo-700 transition-all">
        Confirm
      </button>
    </div>
  </div>
</div>

<!-- Input Modal (for prompts) -->
<div id="input-modal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[90] flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl max-w-md w-full shadow-2xl animate-in fade-in zoom-in duration-200">
    <div class="border-b px-6 py-4">
      <h3 id="input-title" class="text-lg font-bold text-slate-800">Enter Value</h3>
      <p id="input-description" class="text-sm text-slate-500 mt-1">Please provide the required information.</p>
    </div>
    <div class="p-6">
      <input type="text" id="input-field" class="w-full px-4 py-3 border border-slate-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm" placeholder="">
      <div id="input-options" class="hidden mt-4 space-y-2">
        <!-- Radio options will be inserted here -->
      </div>
    </div>
    <div class="border-t px-6 py-4 flex justify-end gap-3 bg-slate-50 rounded-b-2xl">
      <button onclick="closeInputModal(null)" class="px-5 py-2.5 text-slate-700 bg-white border border-slate-300 rounded-xl font-bold text-sm hover:bg-slate-50 transition-all">
        Cancel
      </button>
      <button onclick="submitInputModal()" class="px-5 py-2.5 bg-indigo-600 text-white rounded-xl font-bold text-sm hover:bg-indigo-700 transition-all">
        Submit
      </button>
    </div>
  </div>
</div>

<!-- Alert/Success Modal -->
<div id="alert-modal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-[90] flex items-center justify-center p-4">
  <div class="bg-white rounded-2xl max-w-md w-full shadow-2xl animate-in fade-in zoom-in duration-200">
    <div class="p-6 text-center">
      <div id="alert-icon" class="w-16 h-16 mx-auto mb-4 bg-green-100 text-green-600 rounded-full flex items-center justify-center">
        <i class="fi fi-rr-check text-3xl"></i>
      </div>
      <h3 id="alert-title" class="text-xl font-bold text-slate-800 mb-2">Success!</h3>
      <p id="alert-message" class="text-slate-500">Operation completed successfully.</p>
    </div>
    <div class="border-t px-6 py-4 flex justify-center bg-slate-50 rounded-b-2xl">
      <button onclick="closeAlertModal()" class="px-8 py-2.5 bg-indigo-600 text-white rounded-xl font-bold text-sm hover:bg-indigo-700 transition-all">
        OK
      </button>
    </div>
  </div>
</div>

<script>
// ===== TOAST NOTIFICATIONS =====
function showToast(message, type = 'info', duration = 4000) {
  const container = document.getElementById('toast-container');
  const toast = document.createElement('div');
  
  const icons = {
    success: 'fi-rr-check-circle',
    error: 'fi-rr-exclamation',
    warning: 'fi-rr-exclamation',
    info: 'fi-rr-info'
  };
  
  const colors = {
    success: 'bg-green-500',
    error: 'bg-red-500',
    warning: 'bg-amber-500',
    info: 'bg-blue-500'
  };
  
  toast.className = `${colors[type]} text-white px-5 py-3.5 rounded-xl font-semibold text-sm flex items-center gap-3 shadow-lg animate-in slide-in-from-right duration-300`;
  toast.innerHTML = `
    <i class="fi ${icons[type]} text-lg"></i>
    <span>${message}</span>
    <button onclick="this.parentElement.remove()" class="ml-auto hover:opacity-80">
      <i class="fi fi-rr-cross-small text-lg"></i>
    </button>
  `;
  
  container.appendChild(toast);
  
  setTimeout(() => {
    toast.classList.add('animate-out', 'slide-out-to-right');
    setTimeout(() => toast.remove(), 300);
  }, duration);
}

// ===== CONFIRM MODAL =====
let confirmResolve = null;

function showConfirmModal(title, message, type = 'warning') {
  return new Promise((resolve) => {
    confirmResolve = resolve;
    
    const modal = document.getElementById('confirm-modal');
    const iconEl = document.getElementById('confirm-icon');
    const titleEl = document.getElementById('confirm-title');
    const messageEl = document.getElementById('confirm-message');
    const btnEl = document.getElementById('confirm-btn');
    
    titleEl.textContent = title;
    messageEl.textContent = message;
    
    const iconColors = {
      warning: { bg: 'bg-amber-100', text: 'text-amber-600', icon: 'fi-rr-exclamation' },
      danger: { bg: 'bg-red-100', text: 'text-red-600', icon: 'fi-rr-trash' },
      info: { bg: 'bg-blue-100', text: 'text-blue-600', icon: 'fi-rr-info' },
      success: { bg: 'bg-green-100', text: 'text-green-600', icon: 'fi-rr-check' }
    };
    
    const config = iconColors[type] || iconColors.warning;
    iconEl.className = `w-12 h-12 ${config.bg} ${config.text} rounded-xl flex items-center justify-center`;
    iconEl.innerHTML = `<i class="fi ${config.icon} text-xl"></i>`;
    
    if (type === 'danger') {
      btnEl.className = 'px-5 py-2.5 bg-red-600 text-white rounded-xl font-bold text-sm hover:bg-red-700 transition-all';
    } else {
      btnEl.className = 'px-5 py-2.5 bg-indigo-600 text-white rounded-xl font-bold text-sm hover:bg-indigo-700 transition-all';
    }
    
    modal.classList.remove('hidden');
  });
}

function closeConfirmModal(result) {
  document.getElementById('confirm-modal').classList.add('hidden');
  if (confirmResolve) {
    confirmResolve(result);
    confirmResolve = null;
  }
}

// ===== INPUT/PROMPT MODAL =====
let inputResolve = null;

function showInputModal(title, description, placeholder = '', options = null) {
  return new Promise((resolve) => {
    inputResolve = resolve;
    
    const modal = document.getElementById('input-modal');
    const titleEl = document.getElementById('input-title');
    const descEl = document.getElementById('input-description');
    const inputEl = document.getElementById('input-field');
    const optionsEl = document.getElementById('input-options');
    
    titleEl.textContent = title;
    descEl.textContent = description;
    inputEl.placeholder = placeholder;
    inputEl.value = '';
    
    if (options && options.length > 0) {
      inputEl.classList.add('hidden');
      optionsEl.classList.remove('hidden');
      optionsEl.innerHTML = options.map((opt, i) => `
        <label class="flex items-center gap-3 p-3 border border-slate-200 rounded-xl cursor-pointer hover:bg-slate-50 transition-all">
          <input type="radio" name="input-option" value="${opt.value}" ${i === 0 ? 'checked' : ''} class="w-4 h-4 text-indigo-600">
          <span class="font-medium text-slate-700">${opt.label}</span>
        </label>
      `).join('');
    } else {
      inputEl.classList.remove('hidden');
      optionsEl.classList.add('hidden');
    }
    
    modal.classList.remove('hidden');
    setTimeout(() => inputEl.focus(), 100);
  });
}

function submitInputModal() {
  const inputEl = document.getElementById('input-field');
  const optionsEl = document.getElementById('input-options');
  
  let value;
  if (!inputEl.classList.contains('hidden')) {
    value = inputEl.value;
  } else {
    const selected = optionsEl.querySelector('input[name="input-option"]:checked');
    value = selected ? selected.value : null;
  }
  
  closeInputModal(value);
}

function closeInputModal(result) {
  document.getElementById('input-modal').classList.add('hidden');
  if (inputResolve) {
    inputResolve(result);
    inputResolve = null;
  }
}

// ===== ALERT MODAL =====
let alertResolve = null;

function showAlertModal(title, message, type = 'success') {
  return new Promise((resolve) => {
    alertResolve = resolve;
    
    const modal = document.getElementById('alert-modal');
    const iconEl = document.getElementById('alert-icon');
    const titleEl = document.getElementById('alert-title');
    const messageEl = document.getElementById('alert-message');
    
    titleEl.textContent = title;
    messageEl.textContent = message;
    
    const iconColors = {
      success: { bg: 'bg-green-100', text: 'text-green-600', icon: 'fi-rr-check' },
      error: { bg: 'bg-red-100', text: 'text-red-600', icon: 'fi-rr-cross' },
      warning: { bg: 'bg-amber-100', text: 'text-amber-600', icon: 'fi-rr-exclamation' },
      info: { bg: 'bg-blue-100', text: 'text-blue-600', icon: 'fi-rr-info' }
    };
    
    const config = iconColors[type] || iconColors.success;
    iconEl.className = `w-16 h-16 mx-auto mb-4 ${config.bg} ${config.text} rounded-full flex items-center justify-center`;
    iconEl.innerHTML = `<i class="fi ${config.icon} text-3xl"></i>`;
    
    modal.classList.remove('hidden');
  });
}

function closeAlertModal() {
  document.getElementById('alert-modal').classList.add('hidden');
  if (alertResolve) {
    alertResolve();
    alertResolve = null;
  }
}

// Close modals on escape key
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    closeConfirmModal(false);
    closeInputModal(null);
    closeAlertModal();
  }
});

// Close modals on backdrop click
document.querySelectorAll('#confirm-modal, #input-modal, #alert-modal').forEach(modal => {
  modal.addEventListener('click', (e) => {
    if (e.target === modal) {
      if (modal.id === 'confirm-modal') closeConfirmModal(false);
      else if (modal.id === 'input-modal') closeInputModal(null);
      else closeAlertModal();
    }
  });
});
</script>
